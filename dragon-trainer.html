<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dragon Trainer Articles</title>
</head>
<body>
    <div id="app">
        <article>
            <h3>All Was Burned</h3>
            <em>Published on July 30, 2023 by someone</em>
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Non eaque molestiae cumque neque expedita necessitatibus nemo? Suscipit harum molestiae, error repellat, sunt itaque iste nemo, illum quam necessitatibus temporibus aliquam!</p>
        </article>
    <div>
</body>
<script>
    // https://vanillajsacademy.com/api/dragons.json
    // https://vanillajsacademy.com/api/dragons-author.json
    // json/dragons.json


    let app = document.querySelector('#app');
    let authors = [];

    // Catch errors
    function renderFail() {
        app.innerHTML = "<h3>All Was Burned</h3>"
        app.innerHTML += "<em>Published on July 30, 2023 by someone</em>";
        app.innerHTML += "<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Non eaque molestiae cumque neque expedita necessitatibus nemo? Suscipit harum molestiae, error repellat, sunt itaque iste nemo, illum quam necessitatibus temporibus aliquam!</p>"
    }

    // Render author bio if it exists
    function renderAuthor(author_key) {
        let author = authors.find((author) => {
            return author.author === author_key;
        });

        if (author) {

        }
    }
        
    // Render articles
    function renderArticles(articles_obj) {

        if (!articles_obj || articles_obj < 1) {
            renderFail();
            return;
        }

        let i = 0;
        let author = '';
        app.innerHTML = articles_obj.map((article) => {
            i++;
            author = article.author;
            return `<article><a href="${article.url}"><h3>#${i}: ${article.title}</h3></a><em>Published on ${article.pubdate} by ${article.author}</em><p>${article.article}</p></article>`;
        }).join('');

        renderAuthor(author);
    }

    // Fetch article
    function getArticle() {
        Promise.all([
            fetch('json/dragons.json'),
            fetch('json/dragons-author.json')
        ]).then((responses) => {
            return Promise.all(responses.map((response) => {
                if (response.ok) {
                    return response.json();
                }
                throw response.status;
            }))
        }).then((data) => {
            console.log(data);
            authors = data[1].authors;
        }).catch((error) => {
            console.warn(error);
        });
    }

    getArticle();
    
</script>
</html>

